{"remainingRequest":"/Users/anastasia/Documents/job/vue/mersh/node_modules/thread-loader/dist/cjs.js!/Users/anastasia/Documents/job/vue/mersh/node_modules/babel-loader/lib/index.js!/Users/anastasia/Documents/job/vue/mersh/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/anastasia/Documents/job/vue/mersh/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anastasia/Documents/job/vue/mersh/src/views/OrderRegister.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/anastasia/Documents/job/vue/mersh/src/views/OrderRegister.vue","mtime":1564427829177},{"path":"/Users/anastasia/Documents/job/vue/mersh/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/anastasia/Documents/job/vue/mersh/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/anastasia/Documents/job/vue/mersh/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/anastasia/Documents/job/vue/mersh/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/anastasia/Documents/job/vue/mersh/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"/Users/anastasia/Documents/job/vue/mersh/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport VueRecaptcha from 'vue-recaptcha';\nimport { required, minLength, email } from 'vuelidate/lib/validators';\nimport AwesomeMask from 'awesome-mask';\nimport axios from 'axios';\nimport { mapGetters, mapActions } from 'vuex';\nimport Select from '@/components/Select.vue';\nimport PrettyCheck from 'pretty-checkbox-vue/check';\nimport { scrollMixin } from '@/mixins';\nexport default {\n  name: 'order-register',\n  data: function data() {\n    return {\n      id: 'js-orderRegister',\n      data: {\n        name: '',\n        phone: '',\n        email: '',\n        delivery: '',\n        deliveryId: '',\n        address: '',\n        payment: '',\n        payment_type: '',\n        message: '',\n        recaptchaToken: ''\n      },\n      message: 'Отправить',\n      sitekey: process.env.VUE_APP_RECAPTCHA_TOKEN,\n      recaptcha: false,\n      touchDelivery: false,\n      touchPayment: false,\n      checkboxPrivacy: false,\n      domen: process.env.VUE_APP_DOMEN,\n      deliveryTypes: []\n    };\n  },\n  computed: _objectSpread({}, mapGetters([// 'selectDelivery',\n  'selectPayment', 'selectName', 'selectShow', 'totalPrice', 'cartProducts', 'order', 'orderNumber']), {\n    productsNames: function productsNames() {\n      var names = '';\n      this.cartProducts.forEach(function (elem) {\n        names += elem.name + ', ';\n      });\n      return names;\n    }\n  }),\n  created: function created() {\n    this.getDeliveryTypes();\n    this.orderNumber === '' ? this.getOrderNumber() : '';\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.scroll(0);\n  },\n  validations: {\n    data: {\n      name: {\n        required: required\n      },\n      phone: {\n        required: required,\n        minLength: minLength(18)\n      },\n      email: {\n        email: email\n      },\n      delivery: {\n        required: required\n      },\n      address: {\n        required: required\n      },\n      payment: {\n        required: required\n      }\n    }\n  },\n  methods: _objectSpread({}, mapActions(['filterSelect', 'resetSelect', 'addDelivery', 'setOrderNumber']), {\n    select: function select(value) {\n      switch (value[0]) {\n        case 'delivery':\n          this.data.delivery = value[1].value;\n          this.data.deliveryId = value[1].id;\n          this.touchDelivery = true;\n          this.addDelivery(value[1]);\n          break;\n\n        case 'payment':\n          this.data.payment = value[1].value;\n          this.data.payment_type = value[1].type;\n          this.touchPayment = true;\n          this.message = value[1].value === 'Онлайн' ? 'Оплатить' : 'Отправить';\n          break;\n      }\n    },\n    getOrderNumber: function getOrderNumber() {\n      var context = this;\n      axios.post(context.domen + '/api/checkout/').then(function (res) {\n        // console.log(res)\n        context.setOrderNumber(res.data);\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    },\n    getDeliveryTypes: function getDeliveryTypes() {\n      var context = this;\n      axios.get(context.domen + '/api/delivery').then(function (res) {\n        // console.log(res)\n        res.data.forEach(function (elem) {\n          context.deliveryTypes.push({\n            id: elem.id,\n            value: elem.name,\n            price: elem.price\n          });\n        });\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    },\n    resetForm: function resetForm() {\n      var self = this;\n      Object.keys(self.data).forEach(function (key, index) {\n        self.data[key] = '';\n      });\n      self.$v.$reset();\n      this.touchDelivery = false;\n      this.touchPayment = false;\n      this.checkboxPrivacy = false;\n    },\n    showMessage: function showMessage(value) {\n      var button = document.querySelector('.order-register .button_submit');\n\n      if (!value) {\n        button.classList.add('error');\n      } else {\n        button.classList.add('success');\n      }\n\n      setTimeout(function () {\n        button.classList.remove('error');\n        button.classList.remove('success');\n      }, 1200);\n    },\n    register: function register(recaptchaToken) {\n      this.recaptcha = true;\n      this.data.recaptchaToken = recaptchaToken;\n    },\n    submit: function submit() {\n      var context = this;\n      var array = {\n        'name': this.data.name,\n        'phone': this.data.phone,\n        'email': this.data.email,\n        'address': this.data.address,\n        'msg': this.data.message,\n        'payment_type': this.data.payment_type,\n        'delivery_type': this.data.delivery,\n        'products': this.order\n      };\n      var order = JSON.stringify(context.order);\n      console.log(order);\n      axios.post(context.domen + '/api/order/?id=' + context.orderNumber + '&name=' + context.data.name + '&phone=' + context.data.phone + '&email=' + context.data.email + '&address=' + context.data.address + '&msg=' + context.data.message + '&payment_type=' + context.data.payment_type + '&delivery_type=' + context.data.deliveryId + '&products=' + order).then(function (response) {\n        console.log(response);\n        context.showMessage(1);\n        context.resetForm();\n        context.$refs.recaptcha.reset();\n        context.recaptcha = false;\n        context.$router.push({\n          name: 'order-accept'\n        });\n      }).catch(function (error) {\n        console.log(error);\n        context.showMessage(0); // for test\n        // self.$router.push({ name: 'order-accept' })\n      });\n    },\n    onCaptchaExpired: function onCaptchaExpired() {\n      this.$refs.recaptcha.reset();\n      this.recaptcha = false;\n    }\n  }),\n  directives: {\n    'mask': AwesomeMask\n  },\n  components: {\n    'vue-recaptcha': VueRecaptcha,\n    'app-select': Select,\n    'p-check': PrettyCheck\n  },\n  mixins: [scrollMixin]\n};",{"version":3,"sources":["OrderRegister.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"order-register d-flex flex-column\">\n    <div class=\"container container-main d-flex flex-column flex-grow-1\">\n      <div class=\"container-inner flex-grow-1 d-flex flex-column align-items-center\">\n\n        <form class=\"order-register__form d-flex flex-column align-items-center justify-content-center\">\n          <h2 class=\"title order-register__title\">Оформление заказа</h2>\n          <p class=\"order-register__number\">Заказ №{{ orderNumber }}</p>\n          <p class=\"order-register__products\">{{ productsNames }}</p>\n          <p class=\"order-register__price\">Сумма: {{ totalPrice }} руб.</p>\n\n          <div class=\"order-register__fields\">\n          <div class=\"order-register__field d-flex flex-wrap align-items-center justify-content-between\">\n            <label class=\"order-register__label\">Имя</label>\n            <input class=\"order-register__input\"\n              :class=\"{invalid: $v.data.name.$error}\"\n              type=\"text\"\n              name=\"name\"\n              placeholder=\"Иван Петров\"\n              @blur=\"$v.data.name.$touch()\"\n              v-model=\"data.name\">\n            <p class=\"order-register__error-text\"\n              v-if=\"$v.data.name.$error\">Укажите имя</p>\n          </div>\n\n          <div class=\"order-register__field d-flex flex-wrap align-items-center justify-content-between\">\n            <label class=\"order-register__label\">Телефон</label>\n            <input class=\"order-register__input\"\n              :class=\"{invalid: $v.data.phone.$error}\"\n              type=\"text\"\n              name=\"phone\"\n              placeholder=\"+ 7 (ххх) ххх хх хх\"\n              v-mask=\"'+9 (999) 999-99-99'\"\n              @blur=\"$v.data.phone.$touch()\"\n              v-model=\"data.phone\">\n            <transition name=\"fade\">\n              <p class=\"order-register__error-text\"\n                v-if=\"!$v.data.phone.required && $v.data.phone.$dirty\">\n                Укажите телефон или email\n              </p>\n              <p class=\"order-register__error-text\"\n                v-if=\"!$v.data.phone.minLength\">\n                Введите телефон в формате + 7 (ххх) ххх хх хх\n              </p>\n            </transition>\n          </div>\n\n          <div class=\"order-register__field d-flex flex-wrap align-items-center justify-content-between\">\n            <label class=\"order-register__label\">Email</label>\n            <input class=\"order-register__input\"\n              :class=\"{invalid: $v.data.email.$error}\"\n              type=\"text\"\n              name=\"email\"\n              placeholder=\"mersh@site.com\"\n              @blur=\"$v.data.email.$touch()\"\n              v-model=\"data.email\">\n            <transition name=\"fade\">\n              <p class=\"order-register__error-text\"\n                v-if=\"!$v.data.email.email\">\n                Введите email в формате mersh@site.com\n              </p>\n            </transition>\n          </div>\n\n          <div class=\"order-register__select-wrapper select-wrapper d-flex flex-wrap align-items-center justify-content-between\"\n            :class=\"{invalid: !$v.data.delivery.required && $v.data.delivery.$invalid && touchDelivery}\">\n            <label class=\"order-register__label\">Способ доставки</label>\n            <app-select\n              :id=\"'js-selectDelivery'\"\n              class=\"order-register__select select select_type_register\"\n              :show=\"selectShow && selectName === 'delivery'\"\n              :name=\"'delivery'\"\n              :placeholder=\"'Курьер'\"\n              :options=\"deliveryTypes\"\n              :selected=\"data.delivery\"\n              v-on:updateOption=\"select\">\n            </app-select>\n            <transition name=\"fade\">\n              <p class=\"order-register__error-text order-register__error-text_type_select\"\n                v-if=\"!$v.data.delivery.required && $v.data.delivery.$invalid && touchDelivery\">\n                Укажите способ доставки\n              </p>\n            </transition>\n          </div>\n\n          <div class=\"order-register__field d-flex flex-wrap align-items-center justify-content-between\">\n            <label class=\"order-register__label\">Адрес</label>\n            <input class=\"order-register__input\"\n              :class=\"{invalid: $v.data.address.$error}\"\n              type=\"text\"\n              name=\"address\"\n              placeholder=\"Улица\"\n              @blur=\"$v.data.address.$touch()\"\n              v-model=\"data.address\">\n            <p class=\"order-register__error-text\"\n              v-if=\"$v.data.address.$error\">Укажите адрес</p>\n          </div>\n\n          <div class=\"order-register__select-wrapper select-wrapper d-flex flex-wrap align-items-center justify-content-between\"\n            :class=\"{invalid: !$v.data.payment.required && $v.data.payment.$invalid && touchPayment}\">\n            <label class=\"order-register__label\">Способ оплаты</label>\n            <app-select\n              :id=\"'js-selectPayment'\"\n              class=\"order-register__select select select_type_register\"\n              :show=\"selectShow && selectName === 'payment'\"\n              :name=\"'payment'\"\n              :placeholder=\"'Наличные'\"\n              :options=\"selectPayment\"\n              :selected=\"data.payment\"\n              v-on:updateOption=\"select\">\n            </app-select>\n            <transition name=\"fade\">\n              <p class=\"order-register__error-text order-register__error-text_type_select\"\n                v-if=\"!$v.data.payment.required && $v.data.payment.$invalid && touchPayment\">\n                Укажите cпособ оплаты\n              </p>\n            </transition>\n          </div>\n\n          <div class=\"order-register__field d-flex flex-wrap align-items-center justify-content-between\">\n            <label class=\"order-register__label\">Сообщение</label>\n            <textarea class=\"order-register__textarea\"\n              type=\"text\"\n              name=\"message\"\n              placeholder=\"Текст\"\n              v-model=\"data.message\"></textarea>\n          </div>\n\n          <p-check class=\"order-register__checkbox p-icon\" v-model=\"checkboxPrivacy\">\n            <i class=\"icon fas fa-check d-flex align-items-center justify-content-center\" slot=\"extra\"></i>\n            <p class=\"order-register__checkbox-descr d-flex flex-wrap mb-0\">\n            Я согласен с&nbsp;\n            <router-link class=\"order-register__link\"\n              tag=\"a\"\n              :to=\"{ name: 'privacy' }\">\n              политикой конфиденциальности\n            </router-link>\n            и даю разрешение на обработку персональных данных\n            </p>\n          </p-check>\n\n          </div>\n\n          <vue-recaptcha\n            class=\"recaptcha\"\n            ref=\"recaptcha\"\n            :sitekey=\"sitekey\"\n            @verify=\"register\"\n            @expired=\"onCaptchaExpired\"\n          />\n\n          <div class=\"order-register__buttons d-flex flex-column flex-sm-row align-items-center justify-content-between\">\n            <router-link class=\"order-register__cancel button button_form button_form-page order-2 order-sm-1\"\n              :to=\"{ name: 'cart' }\"\n              tag=\"a\">\n                Отмена\n            </router-link>\n\n            <button class=\"order-register__submit button button_form button_form-page button_submit order-1 order-sm-2 d-flex align-items-center justify-content-center\"\n              data-success=\"Отправлено!\"\n              data-error=\"Ошибка!\"\n              @click.prevent=\"submit\"\n              :disabled=\"$v.$invalid || !recaptcha || !checkboxPrivacy\">\n              <span>{{ message }}</span>\n            </button>\n          </div>\n\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport VueRecaptcha from 'vue-recaptcha'\nimport { required, minLength, email } from 'vuelidate/lib/validators'\nimport AwesomeMask from 'awesome-mask'\nimport axios from 'axios'\nimport { mapGetters, mapActions } from 'vuex'\nimport Select from '@/components/Select.vue'\nimport PrettyCheck from 'pretty-checkbox-vue/check'\nimport { scrollMixin } from '@/mixins'\n\nexport default {\n  name: 'order-register',\n  data () {\n    return {\n      id: 'js-orderRegister',\n      data: {\n        name: '',\n        phone: '',\n        email: '',\n        delivery: '',\n        deliveryId: '',\n        address: '',\n        payment: '',\n        payment_type: '',\n        message: '',\n        recaptchaToken: ''\n      },\n      message: 'Отправить',\n      sitekey: process.env.VUE_APP_RECAPTCHA_TOKEN,\n      recaptcha: false,\n      touchDelivery: false,\n      touchPayment: false,\n      checkboxPrivacy: false,\n      domen: process.env.VUE_APP_DOMEN,\n      deliveryTypes: []\n    }\n  },\n  computed: {\n    ...mapGetters([\n      // 'selectDelivery',\n      'selectPayment',\n      'selectName',\n      'selectShow',\n      'totalPrice',\n      'cartProducts',\n      'order',\n      'orderNumber'\n    ]),\n    productsNames () {\n      var names = ''\n      this.cartProducts.forEach(function (elem) {\n        names += elem.name + ', '\n      })\n      return names\n    }\n  },\n  created () {\n    this.getDeliveryTypes()\n    this.orderNumber === '' ? this.getOrderNumber() : ''\n  },\n  beforeDestroy () {\n    this.scroll(0)\n  },\n  validations: {\n    data: {\n      name: {\n        required\n      },\n      phone: {\n        required,\n        minLength: minLength(18)\n      },\n      email: {\n        email\n      },\n      delivery: {\n        required\n      },\n      address: {\n        required\n      },\n      payment: {\n        required\n      }\n    }\n  },\n  methods: {\n    ...mapActions([\n      'filterSelect',\n      'resetSelect',\n      'addDelivery',\n      'setOrderNumber'\n    ]),\n    select (value) {\n      switch (value[0]) {\n        case 'delivery':\n          this.data.delivery = value[1].value\n          this.data.deliveryId = value[1].id\n          this.touchDelivery = true\n          this.addDelivery(value[1])\n          break\n        case 'payment':\n          this.data.payment = value[1].value\n          this.data.payment_type = value[1].type\n          this.touchPayment = true\n          this.message = value[1].value === 'Онлайн' ? 'Оплатить' : 'Отправить'\n          break\n      }\n    },\n    getOrderNumber () {\n      var context = this\n      axios.post(context.domen + '/api/checkout/')\n        .then(res => {\n          // console.log(res)\n          context.setOrderNumber(res.data)\n        })\n        .catch(error => console.log(error))\n    },\n    getDeliveryTypes () {\n      var context = this\n      axios.get(context.domen + '/api/delivery')\n        .then(res => {\n          // console.log(res)\n          res.data.forEach(function (elem) {\n            context.deliveryTypes.push({\n              id: elem.id,\n              value: elem.name,\n              price: elem.price\n            })\n          })\n        })\n        .catch(error => console.log(error))\n    },\n    resetForm () {\n      var self = this\n      Object.keys(self.data).forEach(function (key, index) {\n        self.data[key] = ''\n      })\n      self.$v.$reset()\n      this.touchDelivery = false\n      this.touchPayment = false\n      this.checkboxPrivacy = false\n    },\n    showMessage (value) {\n      var button = document.querySelector('.order-register .button_submit')\n      if (!value) {\n        button.classList.add('error')\n      } else {\n        button.classList.add('success')\n      }\n      setTimeout(function () {\n        button.classList.remove('error')\n        button.classList.remove('success')\n      }, 1200)\n    },\n    register (recaptchaToken) {\n      this.recaptcha = true\n      this.data.recaptchaToken = recaptchaToken\n    },\n    submit () {\n      var context = this\n\n      var array = {\n        'name': this.data.name,\n        'phone': this.data.phone,\n        'email': this.data.email,\n        'address': this.data.address,\n        'msg': this.data.message,\n        'payment_type': this.data.payment_type,\n        'delivery_type': this.data.delivery,\n        'products': this.order\n      }\n\n      var order = JSON.stringify(context.order)\n      console.log(order)\n\n      axios.post(context.domen + '/api/order/?id=' + context.orderNumber +\n      '&name=' + context.data.name +\n      '&phone=' + context.data.phone +\n      '&email=' + context.data.email +\n      '&address=' + context.data.address +\n      '&msg=' + context.data.message +\n      '&payment_type=' + context.data.payment_type +\n      '&delivery_type=' + context.data.deliveryId +\n      '&products=' + order)\n        .then(function (response) {\n          console.log(response)\n          context.showMessage(1)\n          context.resetForm()\n          context.$refs.recaptcha.reset()\n          context.recaptcha = false\n          context.$router.push({ name: 'order-accept' })\n        })\n        .catch(function (error) {\n          console.log(error)\n          context.showMessage(0)\n\n          // for test\n          // self.$router.push({ name: 'order-accept' })\n        })\n    },\n    onCaptchaExpired () {\n      this.$refs.recaptcha.reset()\n      this.recaptcha = false\n    }\n  },\n  directives: {\n    'mask': AwesomeMask\n  },\n  components: {\n    'vue-recaptcha': VueRecaptcha,\n    'app-select': Select,\n    'p-check': PrettyCheck\n  },\n  mixins: [scrollMixin]\n}\n</script>\n\n<style lang=\"sass\">\n@import '@/sass/_variables.sass'\n.order-register\n  .container-inner\n    // padding-top: 60px\n    // padding-bottom: 127px\n    padding-top: 3.125vw\n    padding-bottom: 6.615vw\n\n.order-register__form\n  width: 100%\n  // border: 1px solid black\n  .recaptcha\n    // margin-bottom: 20px\n    // margin-top: 63px\n    margin-bottom: 1.042vw\n    margin-top: 3.281vw\n\n.order-register__fields\n  // width: 600px\n  width: 31.250vw\n  // border: 1px solid pink\n\n.order-register__title\n  // margin-top: 33px\n  // margin-bottom: 33px\n  margin-top: 1.719vw\n  margin-bottom: 1.719vw\n\n.order-register__number\n  // margin-bottom: 17px\n  margin-bottom: 0.885vw\n  font-family: $font-montserrat\n  // font-size: 31px\n  font-size: 1.615vw\n  font-weight: 400\n  line-height: 1\n  color: $color-brown\n\n.order-register__products\n  // margin-bottom: 6px\n  margin-bottom: 0.313vw\n  font-family: $font-montserrat\n  // font-size: 20px\n  font-size: 1.042vw\n  font-weight: 400\n  line-height: 1\n  color: $color-brown\n\n.order-register__price\n  // margin-bottom: 65px\n  margin-bottom: 3.385vw\n  font-family: $font-montserrat\n  // font-size: 20px\n  font-size: 1.042vw\n  font-weight: 700\n  line-height: 1\n  color: $color-brown\n\n.order-register__select-wrapper\n  position: relative\n  // margin-left: auto\n  // margin-top: 25px\n  margin-top: 1.302vw\n  &.invalid\n    .select__toggle\n      border-bottom: 1px solid red\n\n.order-register__field\n  position: relative\n  width: 100%\n  // margin-top: 25px\n  margin-top: 1.302vw\n\n.order-register__label,\n.order-register__input,\n.order-register__input::placeholder,\n.order-register__descr,\n.order-register__textarea,\n.order-register__textarea::placeholder\n  font-family: $font-montserrat\n  // font-size: 18px\n  font-size: 0.938vw\n  font-weight: 400\n  line-height: 1\n  color: $color-black\n  background-color: transparent\n\n.order-register__label\n  margin-bottom: 0\n\n.order-register__descr\n  line-height: normal\n\n.order-register__input\n  // width: 435px\n  // padding: 25px 0\n  width: 22.656vw\n  padding: 1.302vw 0\n  border: none\n  border-bottom: 1px solid #979797\n  transition: border 0.3s linear\n  &.invalid\n    border-bottom: 1px solid red\n\n.order-register__textarea\n  // width: 435px\n  // padding: 25px 30px\n  width: 22.656vw\n  // height: 227px\n  height: 11.823vw\n  padding: 1.302vw 1.563vw\n  border: 1px solid #979797\n  transition: border 0.3s linear\n  &.invalid\n    border: 1px solid red\n\n.order-register__checkbox\n  display: flex\n  flex-wrap: nowrap\n  // margin-top: 30px\n  margin-top: 1.563vw\n  .state\n    display: flex\n    flex-wrap: nowrap\n  .icon,\n  label::before\n    // width: 20px\n    // height: 20px\n    width: 1.042vw !important\n    height: 1.042vw !important\n  .icon,\n  .icon::before,\n  label::before\n    top: 1px !important\n  .icon::before\n    // font-size: 10px\n    font-size: 0.521vw\n  label\n    text-indent: 0 !important\n    white-space: normal\n\n.order-register__checkbox-descr\n  display: flex\n  // padding-left: 40px\n  padding-left: 2.083vw\n  font-family: $font-montserrat\n  // font-size: 18px\n  font-size: 0.938vw\n  font-weight: 400\n  line-height: normal\n  color: $color-black\n\n.order-register__link\n  z-index: 10\n  position: relative\n  font-family: $font-montserrat\n  // font-size: 18px\n  font-size: 0.938vw\n  font-weight: 400\n  line-height: normal\n  color: $color-black\n  text-decoration: underline\n  transition: opacity 0.3s\n  &:hover\n    color: $color-black\n    opacity: 0.7\n\n.order-register__error-text\n  position: absolute\n  top: 100%\n  right: 0\n  // width: 435px\n  // margin-top: 5px\n  width: 22.656vw\n  margin-top: 0.260vw\n  margin-bottom: 0\n  font-family: $font-montserrat\n  // font-size: 14px\n  font-size: 0.729vw\n  font-weight: 400\n  line-height: 1\n  color: red\n\n.order-register__error-text_type_select\n  // width: 378px\n  width: 19.688vw\n\n.fade-enter,\n.fade-enter-active\n  animation: fade-in 0.3s cubic-bezier(0.390, 0.575, 0.565, 1.000) both\n\n.fade-leave,\n.fade-leave-active\n  animation: fade-out 0.25s ease-out both\n\n@keyframes fade-in\n  0%\n    opacity: 0\n  100%\n    opacity: 1\n\n@keyframes fade-out\n  0%\n    opacity: 1\n  100%\n    opacity: 0\n\n.order-register__buttons\n  // margin-top: 25px\n  margin-top: 1.302vw\n\n.order-register__cancel\n  // margin-right: 40px\n  margin-right: 2.083vw\n\n@media(max-width: 1199px)\n  .order-register\n    .container-inner\n      padding-top: calc(60px / #{$lose-m})\n      padding-bottom: calc(127px / #{$lose-m})\n\n  .order-register__form\n    .recaptcha\n      margin-bottom: calc(20px / #{$lose-m})\n      margin-top: calc(63px / #{$lose-m})\n\n  .order-register__fields\n    width: calc(600px / #{$lose-m})\n\n  .order-register__title\n    margin-top: calc(33px / #{$lose-m})\n    margin-bottom: calc(33px / #{$lose-m})\n\n  .order-register__number\n    margin-bottom: calc(17px / #{$lose-m})\n    font-size: calc(31px / #{$lose-m})\n\n  .order-register__products\n    margin-bottom: calc(6px / #{$lose-m})\n    font-size: calc(20px / #{$lose-m})\n\n  .order-register__price\n    margin-bottom: calc(65px / #{$lose-m})\n    font-size: calc(20px / #{$lose-m})\n\n  .order-register__select-wrapper\n    margin-top: calc(25px / #{$lose-m})\n\n  .order-register__field\n    margin-top: calc(25px / #{$lose-m})\n\n  .order-register__label,\n  .order-register__input,\n  .order-register__input::placeholder,\n  .order-register__descr,\n  .order-register__textarea,\n  .order-register__textarea::placeholder\n    font-size: calc(18px / #{$lose-m})\n\n  .order-register__input\n    width: calc(435px / #{$lose-m})\n    padding: calc(25px / #{$lose-m}) 0\n\n  .order-register__textarea\n    width: calc(435px / #{$lose-m})\n    padding: calc(25px / #{$lose-m}) calc(30px / #{$lose-m})\n    height: calc(227px / #{$lose-m})\n\n  .order-register__checkbox\n    margin-top: calc(30px / #{$lose-m})\n    .icon,\n    label::before\n      width: calc(20px / #{$lose-m}) !important\n      height: calc(20px / #{$lose-m}) !important\n    .icon::before\n      font-size: calc(10px / #{$lose-m})\n\n  .order-register__checkbox-descr\n    padding-left: calc(40px / #{$lose-m})\n    font-size: calc(18px / #{$lose-m})\n\n  .order-register__link\n    font-size: calc(18px / #{$lose-m})\n\n  .order-register__error-text\n    width: calc(435px / #{$lose-m})\n    margin-top: calc(5px / #{$lose-m})\n    font-size: calc(14px / #{$lose-m})\n\n  .order-register__error-text_type_select\n    width: calc(378px / #{$lose-m})\n\n  .order-register__buttons\n    margin-top: calc(25px / #{$lose-m})\n\n  .order-register__cancel\n    margin-right: calc(40px / #{$lose-m})\n\n@media(max-width: 991px)\n  .order-register\n    .container-inner\n      padding-top: calc(60px / #{$lose-s})\n      padding-bottom: calc(127px / #{$lose-s})\n\n  .order-register__form\n    .recaptcha\n      // margin-bottom: calc(20px / #{$lose-s} / 7)\n      margin-bottom: 0\n      margin-top: calc(63px / #{$lose-s} / 7)\n      transform: scale(0.7)\n\n  .order-register__fields\n    width: calc(600px / #{$lose-s})\n\n  .order-register__title\n    margin-top: calc(33px / #{$lose-s})\n    margin-bottom: calc(33px / #{$lose-s})\n\n  .order-register__number\n    margin-bottom: calc(17px / #{$lose-s})\n    font-size: calc(31px / #{$lose-s})\n\n  .order-register__products\n    margin-bottom: calc(6px / #{$lose-s})\n    font-size: calc(20px / #{$lose-s})\n\n  .order-register__price\n    margin-bottom: calc(65px / #{$lose-s})\n    font-size: calc(20px / #{$lose-s})\n\n  .order-register__select-wrapper\n    margin-top: calc(25px / #{$lose-s})\n\n  .order-register__field\n    margin-top: calc(25px / #{$lose-s})\n\n  .order-register__label,\n  .order-register__input,\n  .order-register__input::placeholder,\n  .order-register__descr,\n  .order-register__textarea,\n  .order-register__textarea::placeholder\n    font-size: calc(18px / #{$lose-s})\n\n  .order-register__input\n    width: calc(435px / #{$lose-s})\n    padding: calc(25px / #{$lose-s}) 0\n\n  .order-register__textarea\n    width: calc(435px / #{$lose-s})\n    padding: calc(25px / #{$lose-s}) calc(30px / #{$lose-s})\n    height: calc(227px / #{$lose-s})\n\n  .order-register__checkbox\n    margin-top: calc(30px / #{$lose-s})\n    .icon,\n    label::before\n      width: calc(20px / #{$lose-s}) !important\n      height: calc(20px / #{$lose-s}) !important\n    .icon::before\n      font-size: calc(10px / #{$lose-s})\n\n  .order-register__checkbox-descr\n    padding-left: calc(40px / #{$lose-s})\n    font-size: calc(18px / #{$lose-s})\n\n  .order-register__link\n    font-size: calc(18px / #{$lose-s})\n\n  .order-register__error-text\n    width: calc(435px / #{$lose-s})\n    margin-top: calc(5px / #{$lose-s})\n    font-size: calc(14px / #{$lose-s})\n\n  .order-register__error-text_type_select\n    width: calc(378px / #{$lose-s})\n\n  .order-register__buttons\n    margin-top: calc(25px / #{$lose-s})\n\n  .order-register__cancel\n    margin-right: calc(40px / #{$lose-s})\n\n@media(max-width: 575px)\n  .order-register\n    .container-main\n      padding: 0\n    .container-inner\n      padding-top: calc(3.125vw * #{$gain-xs} / 2)\n      padding-bottom: calc(6.615vw * #{$gain-xs} / 2)\n      padding-left: 15px\n      padding-right: 15px\n\n  .order-register__form\n    .recaptcha\n      margin-bottom: calc(1.042vw * #{$gain-xs})\n      margin-top: calc(3.281vw * #{$gain-xs} / 1.5)\n      transform: scale(0.8)\n\n  .order-register__fields\n    width: 100%\n\n  .order-register__title\n    margin-top: calc(1.719vw * #{$gain-xs})\n    margin-bottom: calc(1.719vw * #{$gain-xs})\n\n  .order-register__number\n    margin-bottom: calc(0.885vw * #{$gain-xs})\n    font-size: calc(1.615vw * #{$gain-xs} * 1.2)\n\n  .order-register__products\n    margin-bottom: calc(0.313vw * #{$gain-xs} * 2)\n    font-size: calc(1.042vw * #{$gain-xs} * 1.3)\n\n  .order-register__price\n    margin-bottom: calc(3.385vw * #{$gain-xs} / 3)\n    font-size: calc(1.042vw * #{$gain-xs} * 1.3)\n\n  .order-register__select-wrapper\n    margin-top: calc(1.302vw * #{$gain-xs})\n\n  .order-register__field\n    margin-top: calc(1.302vw * #{$gain-xs})\n\n  .order-register__label,\n  .order-register__input,\n  .order-register__input::placeholder,\n  .order-register__descr,\n  .order-register__textarea,\n  .order-register__textarea::placeholder\n    font-size: calc(0.938vw * #{$gain-xs} * 1.4)\n\n  .order-register__label\n    width: 100%\n    margin-top: calc(1.302vw * #{$gain-xs} * 1.5)\n    margin-bottom: calc(1.302vw * #{$gain-xs})\n\n  .order-register__input\n    width: 100%\n    padding: calc(1.302vw * #{$gain-xs}) 0\n\n  .order-register__textarea\n    width: 100%\n    height: calc(11.823vw * #{$gain-xs})\n    padding: calc(1.302vw * #{$gain-xs}) calc(1.563vw * #{$gain-xs})\n\n  .order-register__checkbox\n    margin-top: calc(1.563vw * #{$gain-xs})\n    .icon,\n    label::before\n      width: calc(1.042vw * #{$gain-xs} * 1.5) !important\n      height: calc(1.042vw * #{$gain-xs} * 1.5) !important\n    .icon::before\n      font-size: calc(0.521vw * #{$gain-xs} * 1.2 * 1.5)\n\n  .order-register__checkbox-descr\n    padding-left: calc(2.083vw * #{$gain-xs} * 1.5)\n    font-size: calc(0.938vw * #{$gain-xs} * 1.4)\n\n  .order-register__link\n    font-size: calc(0.938vw * #{$gain-xs} * 1.4)\n\n  .order-register__error-text\n    width: 100%\n    margin-top: calc(0.260vw * #{$gain-xs})\n    font-size: calc(0.729vw * #{$gain-xs} * 1.4)\n\n  .order-register__error-text_type_select\n    width: 100%\n\n  .order-register__buttons\n    width: 100%\n    margin-top: calc(1.302vw * #{$gain-xs})\n\n  .order-register__cancel\n    margin-right: 0\n    margin-top: calc(1.302vw * #{$gain-xs})\n</style>\n"],"sourceRoot":"src/views"}]}